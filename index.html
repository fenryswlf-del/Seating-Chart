<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Classroom Seating Chart</title>
  <link rel="stylesheet" href="style.css">

  <!-- Link to manifest for PWA -->
  <link rel="manifest" href="manifest.json">

  <!-- Theme color (choose your brand color here) -->
  <meta name="theme-color" content="#3498db">
</head>
<body>
  <header>
    <h1>Classroom Seating Chart</h1>
    <div class="controls">
      <input type="text" id="new-class" placeholder="Enter class name">
      <button id="add-class">Add Class</button>
      <select id="class-select">
        <option value="">Select a class</option>
      </select>
    </div>
  </header>

  <main id="seating-chart" class="floor">
    <!-- Seating chart will be generated here -->
  </main>

  <script>
    const seatingChart = document.getElementById('seating-chart');
    const addClassBtn = document.getElementById('add-class');
    const newClassInput = document.getElementById('new-class');
    const classSelect = document.getElementById('class-select');

    const ROWS = 5;
    const COLS = 4;

    // Load saved data
    let classes = JSON.parse(localStorage.getItem('classes')) || {};
    updateClassSelect();

    // Add new class
    addClassBtn.addEventListener('click', () => {
      const className = newClassInput.value.trim();
      if (className && !classes[className]) {
        classes[className] = createEmptySeating();
        saveClasses();
        updateClassSelect();
        classSelect.value = className;
        renderSeating(className);
        newClassInput.value = "";
      }
      newClassInput.focus(); // trigger keyboard on phones
    });

    // Switch classes
    classSelect.addEventListener('change', () => {
      const className = classSelect.value;
      if (className) {
        renderSeating(className);
      } else {
        seatingChart.innerHTML = "";
      }
    });

    // Helpers
    function createEmptySeating() {
      const seating = [];
      for (let r = 0; r < ROWS; r++) {
        seating[r] = [];
        for (let c = 0; c < COLS; c++) {
          seating[r][c] = ["", ""]; // 2 seats per table
        }
      }
      return seating;
    }

    function saveClasses() {
      localStorage.setItem('classes', JSON.stringify(classes));
    }

    function updateClassSelect() {
      classSelect.innerHTML = '<option value="">Select a class</option>';
      for (let className in classes) {
        const option = document.createElement('option');
        option.value = className;
        option.textContent = className;
        classSelect.appendChild(option);
      }
    }

    function renderSeating(className) {
      seatingChart.innerHTML = "";
      const seating = classes[className];

      for (let r = 0; r < ROWS; r++) {
        const row = document.createElement('div');
        row.className = 'row';

        for (let c = 0; c < COLS; c++) {
          const table = document.createElement('div');
          table.className = 'table';

          for (let s = 0; s < 2; s++) {
            const input = document.createElement('input');
            input.type = 'text';
            input.placeholder = 'Name';
            input.value = seating[r][c][s];
            input.addEventListener('input', () => {
              seating[r][c][s] = input.value;
              saveClasses();
            });
            table.appendChild(input);
          }
          row.appendChild(table);
        }
        seatingChart.appendChild(row);
      }
    }

    // Register service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(reg => console.log('Service worker registered:', reg))
          .catch(err => console.log('Service worker registration failed:', err));
      });
    }
  </script>
</body>
</html>
